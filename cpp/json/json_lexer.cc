// generated by Textmapper; DO NOT EDIT

#include "json_lexer.h"

#include "absl/log/log.h"
#include "absl/strings/match.h"

namespace json {
namespace {
constexpr int tmNumClasses = 28;

// Latin-1 characters.
constexpr uint8_t tmRuneClass[] = {
    1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  2,  1,  1,  2,  1,  1,  1,  1,  1,
    1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  4,  5,  1,  1,
    1,  1,  1,  1,  6,  7,  8,  9,  10, 11, 12, 13, 13, 13, 13, 13, 13, 13, 13,
    13, 14, 1,  1,  1,  1,  1,  1,  15, 16, 16, 16, 17, 16, 18, 18, 18, 18, 18,
    18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 20, 21, 1,
    1,  1,  16, 22, 16, 16, 17, 22, 18, 18, 18, 18, 18, 18, 18, 23, 18, 18, 18,
    23, 18, 23, 24, 18, 18, 18, 18, 18, 25, 1,  26, 1,  1,  1,  1,  1,  1,  1,
    1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
    1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  27,
    1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  27, 1,  1,  1,  1,  27, 1,  1,  1,
    1,  1,  27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
    27, 27, 27, 27, 27, 27, 1,  27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
    27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
    1,  27, 27, 27, 27, 27, 27, 27, 27,
};

constexpr int tmRuneClassLen = 256;
constexpr int tmFirstRule = -4;

struct MapRange {
  uint32_t lo;
  uint32_t hi;
  uint8_t default_val;
  std::vector<uint8_t> val;
};

const std::vector<MapRange> tmRuneRanges = {
    {256, 706, 27, {}},
    {710, 722, 27, {}},
    {736, 741, 27, {}},
    {748,
     751,
     27,
     {
         27,
         1,
     }},
    {880,
     930,
     27,
     {
         27, 27, 27, 27, 27, 1, 27, 27, 1, 1,  27, 27, 27, 27, 1,
         27, 1,  1,  1,  1,  1, 1,  27, 1, 27, 27, 27, 1,  27, 1,
     }},
    {931, 1014, 27, {}},
    {1015, 1154, 27, {}},
    {1162, 1328, 27, {}},
    {1329, 1367, 27, {}},
    {1369,
     1417,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         1,
         1,
     }},
    {1488, 1515, 27, {}},
    {1519, 1523, 27, {}},
    {1568, 1611, 27, {}},
    {1646,
     1748,
     27,
     {
         27,
         27,
         1,
     }},
    {1749, 1750, 27, {}},
    {1765, 1767, 27, {}},
    {1774, 1776, 27, {}},
    {1786,
     1792,
     27,
     {
         27,
         27,
         27,
         1,
         1,
     }},
    {1808,
     1840,
     27,
     {
         27,
         1,
     }},
    {1869, 1958, 27, {}},
    {1969, 1970, 27, {}},
    {1994, 2027, 27, {}},
    {2036,
     2070,
     27,
     {
         27,
         27,
         1,
         1,
         1,
         1,
         27,
         1,
         1,
         1,
         1,
         1,
     }},
    {2074, 2075, 27, {}},
    {2084,
     2089,
     27,
     {
         27,
         1,
         1,
         1,
     }},
    {2112, 2137, 27, {}},
    {2144, 2155, 27, {}},
    {2160, 2184, 27, {}},
    {2185, 2191, 27, {}},
    {2208, 2250, 27, {}},
    {2308, 2362, 27, {}},
    {2365, 2366, 27, {}},
    {2384,
     2402,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         1,
         1,
         1,
     }},
    {2417, 2433, 27, {}},
    {2437, 2445, 27, {}},
    {2447,
     2473,
     27,
     {
         27,
         27,
         1,
         1,
     }},
    {2474,
     2494,
     27,
     {
         27, 27, 27, 27, 27, 27, 27, 1, 27, 1, 1, 1, 27, 27, 27, 27, 1, 1, 1,
     }},
    {2510, 2511, 27, {}},
    {2524,
     2530,
     27,
     {
         27,
         27,
         1,
     }},
    {2544, 2546, 27, {}},
    {2556, 2557, 27, {}},
    {2565, 2571, 27, {}},
    {2575,
     2601,
     27,
     {
         27,
         27,
         1,
         1,
     }},
    {2602,
     2618,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {2649,
     2655,
     27,
     {
         27,
         27,
         27,
         27,
         1,
     }},
    {2674, 2677, 27, {}},
    {2693, 2702, 27, {}},
    {2703,
     2729,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {2730,
     2750,
     27,
     {
         27, 27, 27, 27, 27, 27, 27, 1, 27, 27, 1, 27, 27, 27, 27, 27, 1, 1, 1,
     }},
    {2768, 2769, 27, {}},
    {2784, 2786, 27, {}},
    {2809, 2810, 27, {}},
    {2821, 2829, 27, {}},
    {2831,
     2857,
     27,
     {
         27,
         27,
         1,
         1,
     }},
    {2858,
     2878,
     27,
     {
         27, 27, 27, 27, 27, 27, 27, 1, 27, 27, 1, 27, 27, 27, 27, 27, 1, 1, 1,
     }},
    {2908,
     2914,
     27,
     {
         27,
         27,
         1,
     }},
    {2929, 2930, 27, {}},
    {2947,
     2955,
     27,
     {
         27,
         1,
     }},
    {2958,
     3002,
     27,
     {
         27, 27, 27, 1, 27, 27, 27, 27, 1, 1, 1,  27, 27, 1, 27, 1,
         27, 27, 1,  1, 1,  27, 27, 1,  1, 1, 27, 27, 27, 1, 1,  1,
     }},
    {3024, 3025, 27, {}},
    {3077, 3085, 27, {}},
    {3086,
     3113,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {3114, 3130, 27, {}},
    {3133, 3134, 27, {}},
    {3160,
     3170,
     27,
     {
         27,
         27,
         27,
         1,
         1,
         27,
         1,
         1,
     }},
    {3200,
     3213,
     27,
     {
         27,
         1,
         1,
         1,
         1,
     }},
    {3214,
     3241,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {3242, 3252, 27, {}},
    {3253,
     3262,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         1,
         1,
         1,
     }},
    {3293,
     3298,
     27,
     {
         27,
         27,
         1,
     }},
    {3313, 3315, 27, {}},
    {3332, 3341, 27, {}},
    {3342,
     3387,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {3389, 3390, 27, {}},
    {3406,
     3415,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         1,
     }},
    {3423, 3426, 27, {}},
    {3450, 3456, 27, {}},
    {3461, 3479, 27, {}},
    {3482, 3506, 27, {}},
    {3507, 3516, 27, {}},
    {3517,
     3527,
     27,
     {
         27,
         1,
         1,
     }},
    {3585, 3633, 27, {}},
    {3634, 3636, 27, {}},
    {3648, 3655, 27, {}},
    {3713,
     3748,
     27,
     {
         27,
         27,
         1,
         27,
         1,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {3749,
     3761,
     27,
     {
         27,
         1,
     }},
    {3762, 3764, 27, {}},
    {3773,
     3783,
     27,
     {
         27,
         1,
         1,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {3804, 3808, 27, {}},
    {3840, 3841, 27, {}},
    {3904, 3912, 27, {}},
    {3913, 3949, 27, {}},
    {3976, 3981, 27, {}},
    {4096, 4139, 27, {}},
    {4159, 4160, 27, {}},
    {4176, 4182, 27, {}},
    {4186,
     4199,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         1,
         1,
         27,
         1,
         1,
         1,
     }},
    {4206,
     4226,
     27,
     {
         27,
         27,
         27,
         1,
         1,
         1,
         1,
     }},
    {4238, 4239, 27, {}},
    {4256, 4294, 27, {}},
    {4295,
     4347,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         1,
         27,
         1,
         1,
     }},
    {4348, 4681, 27, {}},
    {4682,
     4745,
     27,
     {
         27, 27, 27, 27, 1, 1,  27, 27, 27, 27, 27,
         27, 27, 1,  27, 1, 27, 27, 27, 27, 1,  1,
     }},
    {4746,
     4785,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {4786,
     4823,
     27,
     {
         27, 27, 27, 27, 1, 1,  27, 27, 27, 27, 27,
         27, 27, 1,  27, 1, 27, 27, 27, 27, 1,  1,
     }},
    {4824, 4881, 27, {}},
    {4882,
     4955,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {4992, 5008, 27, {}},
    {5024, 5110, 27, {}},
    {5112, 5118, 27, {}},
    {5121, 5741, 27, {}},
    {5743, 5760, 27, {}},
    {5761, 5787, 27, {}},
    {5792, 5867, 27, {}},
    {5873, 5881, 27, {}},
    {5888, 5906, 27, {}},
    {5919, 5938, 27, {}},
    {5952, 5970, 27, {}},
    {5984, 5997, 27, {}},
    {5998, 6001, 27, {}},
    {6016, 6068, 27, {}},
    {6103,
     6109,
     27,
     {
         27,
         1,
         1,
         1,
         1,
     }},
    {6176, 6265, 27, {}},
    {6272,
     6313,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {6314,
     6390,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         1,
     }},
    {6400, 6431, 27, {}},
    {6480, 6510, 27, {}},
    {6512, 6517, 27, {}},
    {6528, 6572, 27, {}},
    {6576, 6602, 27, {}},
    {6656, 6679, 27, {}},
    {6688, 6741, 27, {}},
    {6823, 6824, 27, {}},
    {6917, 6964, 27, {}},
    {6981, 6989, 27, {}},
    {7043, 7073, 27, {}},
    {7086, 7088, 27, {}},
    {7098, 7142, 27, {}},
    {7168, 7204, 27, {}},
    {7245, 7248, 27, {}},
    {7258, 7294, 27, {}},
    {7296, 7305, 27, {}},
    {7312, 7355, 27, {}},
    {7357, 7360, 27, {}},
    {7401,
     7616,
     27,
     {
         27, 27, 27, 27, 1, 27, 27, 27, 27, 27, 27, 1,
         27, 27, 1,  1,  1, 27, 1,  1,  1,  1,  1,
     }},
    {7680, 7958, 27, {}},
    {7960,
     8006,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {8008,
     8024,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {8025,
     8062,
     27,
     {
         27,
         1,
         27,
         1,
         27,
         1,
     }},
    {8064, 8117, 27, {}},
    {8118,
     8141,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         1,
         1,
         1,
         27,
         27,
         27,
         1,
     }},
    {8144,
     8156,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {8160, 8173, 27, {}},
    {8178,
     8189,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {8305, 8306, 27, {}},
    {8319, 8320, 27, {}},
    {8336, 8349, 27, {}},
    {8450,
     8468,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         27,
         1,
         1,
     }},
    {8469,
     8478,
     27,
     {
         27,
         1,
         1,
         1,
     }},
    {8484,
     8506,
     27,
     {
         27,
         1,
         27,
         1,
         27,
         1,
         27,
         27,
         27,
         27,
         1,
     }},
    {8508, 8512, 27, {}},
    {8517, 8522, 27, {}},
    {8526, 8527, 27, {}},
    {8579, 8581, 27, {}},
    {11264, 11493, 27, {}},
    {11499,
     11508,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         1,
         1,
     }},
    {11520, 11558, 27, {}},
    {11559,
     11624,
     27,
     {
         27,
         1,
         1,
         1,
         1,
         1,
         27,
         1,
         1,
     }},
    {11631, 11632, 27, {}},
    {11648, 11671, 27, {}},
    {11680,
     11743,
     27,
     {
         27, 27, 27, 27, 27, 27, 27, 1,  27, 27, 27, 27, 27, 27,
         27, 1,  27, 27, 27, 27, 27, 27, 27, 1,  27, 27, 27, 27,
         27, 27, 27, 1,  27, 27, 27, 27, 27, 27, 27, 1,  27, 27,
         27, 27, 27, 27, 27, 1,  27, 27, 27, 27, 27, 27, 27, 1,
     }},
    {11823, 11824, 27, {}},
    {12293, 12295, 27, {}},
    {12337, 12342, 27, {}},
    {12347,
     12439,
     27,
     {
         27,
         27,
         1,
         1,
         1,
         1,
     }},
    {12445,
     12539,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {12540, 12544, 27, {}},
    {12549, 12592, 27, {}},
    {12593, 12687, 27, {}},
    {12704, 12736, 27, {}},
    {12784, 12800, 27, {}},
    {13312, 19904, 27, {}},
    {19968, 42125, 27, {}},
    {42192, 42238, 27, {}},
    {42240, 42509, 27, {}},
    {42512, 42528, 27, {}},
    {42538, 42540, 27, {}},
    {42560, 42607, 27, {}},
    {42623, 42654, 27, {}},
    {42656, 42726, 27, {}},
    {42775, 42784, 27, {}},
    {42786, 42889, 27, {}},
    {42891, 42955, 27, {}},
    {42960,
     42970,
     27,
     {
         27,
         27,
         1,
         27,
         1,
     }},
    {42994, 43010, 27, {}},
    {43011,
     43043,
     27,
     {
         27,
         27,
         27,
         1,
         27,
         27,
         27,
         27,
         1,
     }},
    {43072, 43124, 27, {}},
    {43138, 43188, 27, {}},
    {43250, 43256, 27, {}},
    {43259,
     43263,
     27,
     {
         27,
         1,
     }},
    {43274, 43302, 27, {}},
    {43312, 43335, 27, {}},
    {43360, 43389, 27, {}},
    {43396, 43443, 27, {}},
    {43471, 43472, 27, {}},
    {43488,
     43504,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {43514,
     43561,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {43584,
     43596,
     27,
     {
         27,
         27,
         27,
         1,
     }},
    {43616, 43639, 27, {}},
    {43642,
     43696,
     27,
     {
         27,
         1,
         1,
         1,
     }},
    {43697,
     43715,
     27,
     {
         27,
         1,
         1,
         1,
         27,
         27,
         1,
         1,
         27,
         27,
         27,
         27,
         27,
         1,
         1,
         27,
         1,
     }},
    {43739,
     43755,
     27,
     {
         27,
         27,
         27,
         1,
         1,
     }},
    {43762, 43765, 27, {}},
    {43777,
     43799,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         1,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {43808,
     43867,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {43868, 43882, 27, {}},
    {43888, 44003, 27, {}},
    {44032, 55204, 27, {}},
    {55216, 55239, 27, {}},
    {55243, 55292, 27, {}},
    {63744, 64110, 27, {}},
    {64112, 64218, 27, {}},
    {64256, 64263, 27, {}},
    {64275, 64280, 27, {}},
    {64285,
     64297,
     27,
     {
         27,
         1,
     }},
    {64298, 64311, 27, {}},
    {64312,
     64434,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         1,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {64467, 64830, 27, {}},
    {64848, 64912, 27, {}},
    {64914, 64968, 27, {}},
    {65008, 65020, 27, {}},
    {65136,
     65277,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {65313, 65339, 27, {}},
    {65345, 65371, 27, {}},
    {65382, 65471, 27, {}},
    {65474,
     65501,
     27,
     {
         27, 27, 27, 27, 27, 27, 1,  1,  27, 27, 27, 27,
         27, 27, 1,  1,  27, 27, 27, 27, 27, 27, 1,  1,
     }},
    {65536, 65548, 27, {}},
    {65549, 65575, 27, {}},
    {65576, 65595, 27, {}},
    {65596,
     65614,
     27,
     {
         27,
         27,
         1,
     }},
    {65616, 65630, 27, {}},
    {65664, 65787, 27, {}},
    {66176, 66205, 27, {}},
    {66208, 66257, 27, {}},
    {66304, 66336, 27, {}},
    {66349, 66369, 27, {}},
    {66370, 66378, 27, {}},
    {66384, 66422, 27, {}},
    {66432, 66462, 27, {}},
    {66464, 66500, 27, {}},
    {66504, 66512, 27, {}},
    {66560, 66718, 27, {}},
    {66736, 66772, 27, {}},
    {66776, 66812, 27, {}},
    {66816, 66856, 27, {}},
    {66864, 66916, 27, {}},
    {66928, 66939, 27, {}},
    {66940, 66955, 27, {}},
    {66956,
     66978,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {66979, 66994, 27, {}},
    {66995,
     67005,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {67072, 67383, 27, {}},
    {67392, 67414, 27, {}},
    {67424, 67432, 27, {}},
    {67456,
     67505,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {67506, 67515, 27, {}},
    {67584,
     67638,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         1,
         27,
         1,
     }},
    {67639,
     67670,
     27,
     {
         27,
         27,
         1,
         1,
         1,
         27,
         1,
         1,
     }},
    {67680, 67703, 27, {}},
    {67712, 67743, 27, {}},
    {67808, 67827, 27, {}},
    {67828, 67830, 27, {}},
    {67840, 67862, 27, {}},
    {67872, 67898, 27, {}},
    {67968, 68024, 27, {}},
    {68030, 68032, 27, {}},
    {68096, 68097, 27, {}},
    {68112,
     68150,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         27,
         1,
     }},
    {68192, 68221, 27, {}},
    {68224, 68253, 27, {}},
    {68288, 68296, 27, {}},
    {68297, 68325, 27, {}},
    {68352, 68406, 27, {}},
    {68416, 68438, 27, {}},
    {68448, 68467, 27, {}},
    {68480, 68498, 27, {}},
    {68608, 68681, 27, {}},
    {68736, 68787, 27, {}},
    {68800, 68851, 27, {}},
    {68864, 68900, 27, {}},
    {69248, 69290, 27, {}},
    {69296, 69298, 27, {}},
    {69376, 69405, 27, {}},
    {69415, 69416, 27, {}},
    {69424, 69446, 27, {}},
    {69488, 69506, 27, {}},
    {69552, 69573, 27, {}},
    {69600, 69623, 27, {}},
    {69635, 69688, 27, {}},
    {69745,
     69750,
     27,
     {
         27,
         27,
         1,
         1,
     }},
    {69763, 69808, 27, {}},
    {69840, 69865, 27, {}},
    {69891, 69927, 27, {}},
    {69956,
     69960,
     27,
     {
         27,
         1,
         1,
     }},
    {69968, 70003, 27, {}},
    {70006, 70007, 27, {}},
    {70019, 70067, 27, {}},
    {70081, 70085, 27, {}},
    {70106,
     70109,
     27,
     {
         27,
         1,
     }},
    {70144, 70162, 27, {}},
    {70163, 70188, 27, {}},
    {70207, 70209, 27, {}},
    {70272,
     70302,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         1,
         27,
         27,
         27,
         27,
         1,
     }},
    {70303, 70313, 27, {}},
    {70320, 70367, 27, {}},
    {70405, 70413, 27, {}},
    {70415,
     70441,
     27,
     {
         27,
         27,
         1,
         1,
     }},
    {70442,
     70462,
     27,
     {
         27, 27, 27, 27, 27, 27, 27, 1, 27, 27, 1, 27, 27, 27, 27, 27, 1, 1, 1,
     }},
    {70480, 70481, 27, {}},
    {70493, 70498, 27, {}},
    {70656, 70709, 27, {}},
    {70727, 70731, 27, {}},
    {70751, 70754, 27, {}},
    {70784, 70832, 27, {}},
    {70852,
     70856,
     27,
     {
         27,
         27,
         1,
     }},
    {71040, 71087, 27, {}},
    {71128, 71132, 27, {}},
    {71168, 71216, 27, {}},
    {71236, 71237, 27, {}},
    {71296, 71339, 27, {}},
    {71352, 71353, 27, {}},
    {71424, 71451, 27, {}},
    {71488, 71495, 27, {}},
    {71680, 71724, 27, {}},
    {71840, 71904, 27, {}},
    {71935, 71943, 27, {}},
    {71945,
     71956,
     27,
     {
         27,
         1,
         1,
     }},
    {71957,
     71984,
     27,
     {
         27,
         27,
         1,
     }},
    {71999,
     72002,
     27,
     {
         27,
         1,
     }},
    {72096, 72104, 27, {}},
    {72106, 72145, 27, {}},
    {72161,
     72164,
     27,
     {
         27,
         1,
     }},
    {72192, 72193, 27, {}},
    {72203, 72243, 27, {}},
    {72250, 72251, 27, {}},
    {72272, 72273, 27, {}},
    {72284, 72330, 27, {}},
    {72349, 72350, 27, {}},
    {72368, 72441, 27, {}},
    {72704, 72713, 27, {}},
    {72714, 72751, 27, {}},
    {72768, 72769, 27, {}},
    {72818, 72848, 27, {}},
    {72960,
     73009,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {73030, 73031, 27, {}},
    {73056,
     73098,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {73112, 73113, 27, {}},
    {73440, 73459, 27, {}},
    {73474,
     73489,
     27,
     {
         27,
         1,
     }},
    {73490, 73524, 27, {}},
    {73648, 73649, 27, {}},
    {73728, 74650, 27, {}},
    {74880, 75076, 27, {}},
    {77712, 77809, 27, {}},
    {77824, 78896, 27, {}},
    {78913, 78919, 27, {}},
    {82944, 83527, 27, {}},
    {92160, 92729, 27, {}},
    {92736, 92767, 27, {}},
    {92784, 92863, 27, {}},
    {92880, 92910, 27, {}},
    {92928, 92976, 27, {}},
    {92992, 92996, 27, {}},
    {93027, 93048, 27, {}},
    {93053, 93072, 27, {}},
    {93760, 93824, 27, {}},
    {93952, 94027, 27, {}},
    {94032, 94033, 27, {}},
    {94099, 94112, 27, {}},
    {94176,
     94180,
     27,
     {
         27,
         27,
         1,
     }},
    {94208, 100344, 27, {}},
    {100352, 101590, 27, {}},
    {101632, 101641, 27, {}},
    {110576,
     110883,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {110898, 110899, 27, {}},
    {110928,
     110934,
     27,
     {
         27,
         27,
         27,
         1,
         1,
     }},
    {110948, 110952, 27, {}},
    {110960, 111356, 27, {}},
    {113664, 113771, 27, {}},
    {113776, 113789, 27, {}},
    {113792, 113801, 27, {}},
    {113808, 113818, 27, {}},
    {119808, 119893, 27, {}},
    {119894, 119965, 27, {}},
    {119966,
     119994,
     27,
     {
         27,
         27,
         1,
         1,
         27,
         1,
         1,
         27,
         27,
         1,
         1,
         27,
         27,
         27,
         27,
         1,
     }},
    {119995,
     120070,
     27,
     {
         27,
         1,
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {120071,
     120085,
     27,
     {
         27,
         27,
         27,
         27,
         1,
         1,
     }},
    {120086,
     120122,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {120123,
     120486,
     27,
     {
         27, 27, 27, 27, 1,  27, 27, 27, 27, 27, 1, 27,
         1,  1,  1,  27, 27, 27, 27, 27, 27, 27, 1,
     }},
    {120488, 120513, 27, {}},
    {120514, 120539, 27, {}},
    {120540, 120571, 27, {}},
    {120572, 120597, 27, {}},
    {120598, 120629, 27, {}},
    {120630, 120655, 27, {}},
    {120656, 120687, 27, {}},
    {120688, 120713, 27, {}},
    {120714, 120745, 27, {}},
    {120746, 120771, 27, {}},
    {120772, 120780, 27, {}},
    {122624, 122655, 27, {}},
    {122661, 122667, 27, {}},
    {122928, 122990, 27, {}},
    {123136, 123181, 27, {}},
    {123191, 123198, 27, {}},
    {123214, 123215, 27, {}},
    {123536, 123566, 27, {}},
    {123584, 123628, 27, {}},
    {124112, 124140, 27, {}},
    {124896,
     124927,
     27,
     {
         27,
         27,
         27,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         27,
         27,
         1,
         27,
         27,
         1,
     }},
    {124928, 125125, 27, {}},
    {125184, 125252, 27, {}},
    {125259, 125260, 27, {}},
    {126464,
     126496,
     27,
     {
         27,
         27,
         27,
         27,
         1,
     }},
    {126497,
     126515,
     27,
     {
         27,
         27,
         1,
         27,
         1,
         1,
         27,
         1,
     }},
    {126516,
     126602,
     27,
     {
         27, 27, 27, 27, 1,  27, 1,  27, 1,  1,  1,  1,  1,  1,  27, 1,
         1,  1,  1,  27, 1,  27, 1,  27, 1,  27, 27, 27, 1,  27, 27, 1,
         27, 1,  1,  27, 1,  27, 1,  27, 1,  27, 1,  27, 1,  27, 27, 1,
         27, 1,  1,  27, 27, 27, 27, 1,  27, 27, 27, 27, 27, 27, 27, 1,
         27, 27, 27, 27, 1,  27, 27, 27, 27, 1,  27, 1,
     }},
    {126603, 126620, 27, {}},
    {126625,
     126652,
     27,
     {
         27,
         27,
         27,
         1,
         27,
         27,
         27,
         27,
         27,
         1,
     }},
    {131072, 173792, 27, {}},
    {173824, 177978, 27, {}},
    {177984, 178206, 27, {}},
    {178208, 183970, 27, {}},
    {183984, 191457, 27, {}},
    {194560, 195102, 27, {}},
    {196608, 201547, 27, {}},
    {201552, 205744, 27, {}},
};

uint32_t mapRune(int32_t c) {
  uint32_t lo = 0;
  uint32_t hi = tmRuneRanges.size();
  while (lo < hi) {
    uint32_t m = lo + (hi - lo) / 2;
    const MapRange& r = tmRuneRanges[m];
    if (c < r.lo) {
      hi = m;
    } else if (c >= r.hi) {
      lo = m + 1;
    } else {
      uint32_t i = c - r.lo;
      if (i < r.val.size()) {
        return static_cast<uint32_t>(r.val[i]);
      }
      return static_cast<uint32_t>(r.default_val);
    }
  }
  return 1;
}

constexpr int tmStateMap[] = {
    0,
    31,
};

constexpr int8_t tmToken[] = {
    1, 0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 17,
};

constexpr int8_t tmLexerAction[] = {
    -5,  -4,  30,  -4,  23,  -4,  -4,  -4,  22,  21,  -4,  17,  16,  10,  9,
    6,   5,   5,   5,   4,   -4,  3,   5,   5,   5,   2,   1,   -4,  -7,  -7,
    -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,
    -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -6,  -6,  -6,  -6,
    -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,
    -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -9,  -9,  -9,  -9,  -9,  -9,
    -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,
    -9,  -9,  -9,  -9,  -9,  -9,  -9,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,
    -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,
    -8,  -8,  -8,  -8,  -8,  -17, -17, -17, -17, -17, -17, -17, -17, -17, -17,
    -17, -17, 5,   5,   -17, 5,   5,   5,   5,   -17, -17, -17, 5,   5,   5,
    -17, -17, -17, -17, -17, -17, -1,  -17, -17, -17, -17, -17, -17, -17, -17,
    5,   5,   -17, 5,   5,   5,   5,   -17, -17, -17, 5,   5,   5,   -17, -17,
    -17, -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  8,   8,   8,   8,   -4,  -4,  -4,  8,   8,   8,   -4,  -4,  8,   -23,
    -23, -23, -23, -23, -23, -23, -23, -23, -23, -23, -23, -23, -23, -23, 8,
    8,   8,   8,   -23, -23, -23, 8,   8,   8,   -23, -23, 8,   -10, -10, -10,
    -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10,
    -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -16, -16, -16, -16, -16,
    -16, -16, -16, -16, -16, -2,  -16, 10,  10,  -16, -16, -16, -3,  -16, -16,
    -16, -16, -16, -16, -16, -16, -16, -16, -4,  -4,  -4,  -4,  -4,  -4,  -4,
    13,  -4,  13,  -4,  -4,  12,  12,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  -4,  -4,  -4,  -4,  -16, -16, -16, -16, -16, -16, -16, -16, -16,
    -16, -16, -16, 12,  12,  -16, -16, -16, -16, -16, -16, -16, -16, -16, -16,
    -16, -16, -16, -16, -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  12,  12,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  15,
    15,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -16, -16, -16, -16, -16, -16, -16, -16, -16, -16, -16, -16, 15,  15,  -16,
    -16, -16, -3,  -16, -16, -16, -16, -16, -16, -16, -16, -16, -16, -16, -16,
    -16, -16, -16, -16, -16, -16, -16, -16, -2,  -16, -16, -16, -16, -16, -16,
    -3,  -16, -16, -16, -16, -16, -16, -16, -16, -16, -16, -4,  -4,  -4,  -4,
    -4,  -4,  18,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  18,  18,  18,  18,  18,
    19,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,
    18,  18,  18,  18,  18,  18,  18,  -4,  18,  18,  18,  18,  18,  19,  18,
    18,  18,  18,  20,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,  18,
    18,  18,  18,  18,  18,  -14, -14, -14, -14, -14, -14, -14, -14, -14, -14,
    -14, -14, -14, -14, -14, -14, -14, -14, -14, -14, -14, -14, -14, -14, -14,
    -14, -14, -14, -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    16,  10,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11,
    -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -4,
    23,  23,  23,  29,  23,  23,  23,  23,  23,  23,  23,  23,  23,  23,  23,
    23,  23,  23,  23,  24,  23,  23,  23,  23,  23,  23,  23,  -4,  -4,  -4,
    -4,  23,  -4,  -4,  -4,  -4,  -4,  -4,  23,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  23,  -4,  23,  23,  25,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  -4,  -4,  -4,  -4,  -4,  26,  26,  -4,  26,  26,  26,  -4,  -4,
    -4,  -4,  26,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  -4,  -4,  -4,  27,  27,  -4,  27,  27,  27,  -4,  -4,  -4,  -4,
    27,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  -4,  -4,  28,  28,  -4,  28,  28,  28,  -4,  -4,  -4,  -4,  28,  -4,
    -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
    -4,  23,  23,  -4,  23,  23,  23,  -4,  -4,  -4,  -4,  23,  -4,  -4,  -4,
    -4,  -4,  -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15,
    -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15,
    -13, -13, 30,  -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13,
    -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -4,  -4,
    30,  -4,  23,  32,  -4,  -4,  22,  21,  -4,  17,  16,  10,  9,   6,   5,
    5,   5,   4,   -4,  3,   5,   5,   5,   2,   1,   -4,  -12, -12, -12, -12,
    -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12,
    -12, -12, -12, -12, -12, -12, -12, -12, -12,
};

constexpr int tmBacktracking[] = {
    13, 7,   // in id
    12, 14,  // in JSONNumber
    12, 11,  // in JSONNumber
};
}  // namespace

constexpr uint32_t runeErr = 0xfffd;

inline uint32_t decodeRune(std::string_view input, int64_t& offset) {
  uint8_t b0 = input[offset++];
  if (b0 < 0x80) {
    return b0;  // ASCII
  }
  uint8_t head = (b0 >> 3) & 0xf;
  int sz =
      (0x3a550000 >> (head * 2)) & 3;  // 0b10xx -> 1, 0b110x -> 2, 0b1110 -> 3
  if (sz == 0 || offset + sz > input.size()) {
    return runeErr;
  }
  uint8_t b1 = input[offset++];
  if (b1 < 0x80 || b1 >= 0xc0) {
    return runeErr;
  }
  if (sz == 1) {
    return (static_cast<uint32_t>(b0) & 0x1F) << 6 | (b1 & 0x3F);
  }
  uint8_t b2 = input[offset++];
  if (b2 < 0x80 || b2 >= 0xc0) {
    return runeErr;
  }
  if (sz == 2) {
    return (static_cast<uint32_t>(b0) & 0xF) << 12 |
           (static_cast<uint32_t>(b1) & 0x3F) << 6 | (b2 & 0x3F);
  }
  uint8_t b3 = input[offset++];
  if (b3 < 0x80 || b3 >= 0xc0) {
    return runeErr;
  }
  return (static_cast<uint32_t>(b0) & 0x7) << 18 |
         (static_cast<uint32_t>(b1) & 0x3F) << 12 |
         (static_cast<uint32_t>(b2) & 0x3F) << 6 | (b3 & 0x3F);
}

Lexer::Lexer(absl::string_view input_source) {
  source_ = input_source;
  if (absl::StartsWith(source_, bomSeq)) {
    offset_ += bomSeq.size();
  }
  Rewind(offset_);
}

Token Lexer::Next() {
restart:
  token_line_ = line_;
  token_column_ = offset_ - line_offset_ + 1;
  token_offset_ = offset_;

  int state = tmStateMap[static_cast<uint32_t>(start_state_)];
  uint32_t hash = 0;
  int backupRule = -1;
  uint64_t backupOffset;
  uint32_t backupHash = hash;
  while (state >= 0) {
    int curr_class;
    if (input_rune_ < 0) {
      state = tmLexerAction[state * tmNumClasses];
      if (state > tmFirstRule && state < 0) {
        state = (-1 - state) * 2;
        backupRule = tmBacktracking[state];
        backupOffset = offset_;
        backupHash = hash;
        state = tmBacktracking[state + 1];
      }
      continue;
    } else if (input_rune_ < tmRuneClassLen) {
      curr_class = tmRuneClass[input_rune_];
    } else {
      curr_class = mapRune(input_rune_);
    }
    state = tmLexerAction[state * tmNumClasses + curr_class];
    if (state > tmFirstRule) {
      if (state < 0) {
        state = (-1 - state) * 2;
        backupRule = tmBacktracking[state];
        backupOffset = offset_;
        backupHash = hash;
        state = tmBacktracking[state + 1];
      }
      hash = hash * 31 + static_cast<uint32_t>(input_rune_);
      if (input_rune_ == '\n') {
        line_++;
        line_offset_ = offset_;
      }

      // Scan the next character.
      offset_ = scan_offset_;
      if (offset_ < source_.size()) {
        input_rune_ = decodeRune(source_, scan_offset_);
      } else {
        input_rune_ = -1;
      }
    }
  }

  int rule = tmFirstRule - state;
recovered:
  switch (rule) {
    case 13:
      switch (hash & 7) {
        case 1:
          if (hash == 0x41 && "A" == Text()) {
            rule = 17;
            break;
          }
          break;
        case 2:
          if (hash == 0x42 && "B" == Text()) {
            rule = 18;
            break;
          }
          break;
        case 3:
          if (hash == 0x5cb1923 && "false" == Text()) {
            rule = 16;
            break;
          }
          break;
        case 6:
          if (hash == 0x36758e && "true" == Text()) {
            rule = 15;
            break;
          }
          break;
        case 7:
          if (hash == 0x33c587 && "null" == Text()) {
            rule = 14;
            break;
          }
          break;
      }
      break;
    default:
      break;
  }

  Token tok = Token(tmToken[rule]);
  bool space = false;
  switch (rule) {
    case 0:
      if (backupRule >= 0) {
        rule = backupRule;
        hash = backupHash;
        Rewind(backupOffset);
      } else if (offset_ == token_offset_) {
        Rewind(scan_offset_);
      }
      if (rule != 0) {
        goto recovered;
      }
      break;
    case 9:  // space: /[\t\r\n ]+/
      space = true;
      break;
    case 19:  // 'A': /A!\p{L}+/
    {         /*some code */
    } break;
  }
  if (space) {
    goto restart;
  }
  return tok;
}

void Lexer::Rewind(int64_t rewind_offset) {
  if (rewind_offset < offset_) {
    for (int64_t i = rewind_offset; i < offset_; ++i) {
      if (source_[i] == '\n') {
        line_--;
      }
    }
  } else {
    if (rewind_offset > source_.size()) {
      rewind_offset = source_.size();
    }
    for (int64_t i = offset_; i < rewind_offset; ++i) {
      if (source_[i] == '\n') {
        line_++;
      }
    }
  }
  // Looking for \n before and not at offset_.
  line_offset_ = 1 + source_.find_last_of('\n', offset_ - 1);

  // Scan the next character.
  scan_offset_ = rewind_offset;
  offset_ = rewind_offset;
  if (offset_ < source_.size()) {
    input_rune_ = decodeRune(source_, scan_offset_);
  } else {
    input_rune_ = -1;  // Invalid rune for end of input
  }
}

}  // namespace json
